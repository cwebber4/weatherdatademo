select * from ghcn.daily_raw;
select * from ghcn.element;
select * from ghcn.mflag;
select * from ghcn.qflag;
select * from ghcn.sflag;
select * from ghcn.station;
--delete from ghcn.station;

select * from ghcn.station
where state is null or state = '';

select * from ghcn.station
where state not in ('ME','NH','VT','NY','MA','CT','RI','PA','NJ','MD','DE','VA','WV','NC','SC','GA','FL','AL','TN','KY','OH','OK','IL','CO')

--US1COAD0132, US1COAD0153, US1COAD0003, US1COAD0001, US1CODN0073

select * from ghcn.station
where state in ('CO')
--and lower(name) like 'dia%'
and id like 'USW%'
order by name;

select * from ghcn.station
where id in
(
    --US in 1900
    'USC00010377','USC00010836','USC00011099','USC00011288','USC00011324','USC00011685','USC00011694','USC00012207','USC00012240','USC00012577','USC00012727','USC00012758','USC00012971','USC00012976','USC00013024','USC00013151','USC00013399','USC00013511','USC00013519','USC00013783','USC00013816','USC00014627','USC00014798','USC00014845','USC00014976','USC00015108','USC00015529','USC00015555','USC00015847','USC00015875','USC00016121','USC00016640','USC00016719','USC00017304','USC00017366','USC00017620','USC00018024','USC00018178','USC00018385','USC00018391','USC00018398','USC00018438','USC00018446','USC00018469','USC00018859','USC00019103','USC00020380','USC00020680','USC00020768','USC00020958','USC00021026','USC00021306','USC00021849','USC00021870','USC00023102','USC00023110','USC00023393','USC00023621','USC00024089','USC00024453','USC00025274','USC00025467','USC00025627','USC00025825','USC00025921','USC00026116','USC00026250','USC00026546','USC00026561','USC00026796','USC00027326','USC00027388','USC00027480','USC00027560','USC00027563','USC00027751','USC00027849','USC00027884','USC00028012','USC00028343','USC00028619','USC00028647','USC00028792','USC00028799','USC00028815','USC00029166','USC00029271','USC00029334','USC00029420','USC00030150','USC00030220','USC00030234','USC00030528','USC00030936','USC00031152','USC00031596','USC00031632','USC00032442','USC00032444','USC00032564','USC00032580','USC00032670','USC00032930','USC00033132','USC00033164','USC00033242','USC00033466','USC00033734','USC00034251','USC00034562','USC00034638','USC00034756','USC00035112','USC00035186','USC00035187','USC00035480','USC00035508','USC00035754','USC00035820','USC00035908','USC00036174','USC00036248','USC00036352','USC00036804','USC00036918','USC00036928','USC00037582','USC00040204','USC00040439','USC00040693','USC00040943','USC00041018','USC00041614','USC00041779','USC00042147','USC00042239','USC00042389','USC00042705','USC00042805','USC00042862','USC00042871','USC00042958','USC00043111','USC00043161','USC00043191','USC00043381','USC00043452','USC00043571','USC00043621','USC00043747','USC00043875','USC00044022','USC00044232','USC00044288','USC00044527','USC00044711','USC00044735','USC00044773','USC00044884','USC00044890','USC00045032','USC00045123','USC00045532','USC00045840','USC00046074','USC00046115','USC00046136','USC00046332','USC00046458','USC00046730','USC00046960','USC00047050','USC00047111','USC00047195','USC00047296','USC00047306','USC00047370','USC00047446','USC00047723','USC00047738','USC00047810','USC00047821','USC00047866','USC00047902','USC00047916','USC00047940','USC00047950','USC00047957','USC00048210','USC00048351','USC00048557','USC00048702','USC00048839','USC00049122','USC00049173','USC00049177','USC00049200','USC00049285','USC00049367','USC00049423','USC00049582','USC00049604','USC00049866','USC00050370','USC00050848','USC00050909','USC00051071','USC00051294','USC00051401','USC00051440','USC00051564','USC00051741','USC00051973','USC00052192','USC00052432','USC00053005','USC00053038','USC00053261','USC00053359','USC00053546','USC00053662','USC00054076','USC00054082','USC00054172','USC00054750','USC00054770','USC00054834','USC00054945','USC00055327','USC00055394','USC00055484','USC00055722','USC00056280','USC00056832','USC00057167','USC00057337','USC00057370','USC00057428','USC00057460','USC00057862','USC00058064','USC00058204','USC00058212','USC00058429','USC00058458','USC00058510','USC00058756','USC00058931','USC00059243','USC00059295','USC00060801','USC00061499','USC00062655','USC00063446','USC00063989','USC00064767','USC00065309','USC00065892','USC00068138','USC00068906','USC00071330','USC00075915','USC00076020','USC00076410','USC00079600','USC00080228','USC00080478','USC00081046','USC00081356','USC00082220','USC00082229','USC00082827','USC00082915','USC00083316','USC00084198','USC00084289','USC00084393','USC00084620','USC00084731','USC00085099','USC00085372','USC00085643','USC00085690','USC00085705','USC00086210','USC00086414','USC00086584','USC00087205','USC00087665','USC00087812','USC00087838','USC00087851','USC00088082','USC00088573','USC00088737','USC00088754','USC00088786','USC00088824','USC00089417','USC00090041','USC00090131','USC00090140','USC00090190','USC00090253','USC00090430','USC00090485','USC00090500','USC00090581','USC00090787','USC00090979','USC00091200','USC00091488','USC00091601','USC00091732','USC00091982','USC00092161','USC00092318','USC00092475','USC00092685','USC00093060','USC00093271','USC00093386','USC00093409','USC00093506','USC00093516','USC00093567','USC00093621','USC00093712','USC00093810','USC00094110','USC00094170','USC00094255','USC00094671','USC00095290','USC00095314','USC00095394','USC00095438','USC00095555','USC00095585','USC00095882','USC00095988','USC00096038','USC00096126','USC00096255','USC00096335','USC00096600','USC00096905','USC00097070','USC00097130','USC00097165','USC00097240','USC00097276','USC00097430','USC00097455','USC00097600','USC00098284','USC00098535','USC00098547','USC00098666','USC00098740','USC00098985','USC00099020','USC00099157','USC00099186','USC00099194','USC00099291','USC00099506','USC00100149','USC00100227','USC00100470','USC00100493','USC00100915','USC00101313','USC00101408','USC00101663','USC00101667','USC00101956','USC00102667','USC00103460','USC00103930','USC00103942','USC00104442','USC00105080','USC00105086','USC00105230','USC00105236','USC00106152','USC00106254','USC00106542','USC00106586','USC00106785','USC00106891','USC00107264','USC00107386','USC00107706','USC00108062','USC00108548','USC00109637','USC00109698','USC00110055','USC00110187','USC00110286','USC00110338','USC00110492','USC00110766','USC00111169','USC00111265','USC00111280','USC00111288','USC00111329','USC00111386','USC00111436','USC00111767','USC00112140','USC00112193','USC00112348','USC00112483','USC00112497','USC00112687','USC00112736','USC00112931','USC00113109','USC00113270','USC00113312','USC00113320','USC00113335','USC00113384','USC00113522','USC00113572','USC00113612','USC00113693','USC00113717','USC00113764','USC00113879','USC00113930','USC00114108','USC00114442','USC00114770','USC00114814','USC00114823','USC00115111','USC00115326','USC00115405','USC00115430','USC00115515','USC00115712','USC00115768','USC00115791','USC00115833','USC00115846','USC00115888','USC00115901','USC00115927','USC00115943','USC00116011','USC00116093','USC00116446','USC00116526','USC00116558','USC00116579','USC00116610','USC00116700','USC00116769','USC00117345','USC00117551','USC00118147','USC00118199','USC00118353','USC00118386','USC00118452','USC00118604','USC00118684','USC00118781','USC00118916','USC00119021','USC00119221','USC00119331','USC00119822','USC00119854','USC00120177','USC00120200','USC00120334','USC00120784','USC00120831','USC00120852','USC00120975','USC00121197','USC00121229','USC00121719','USC00121747','USC00121772','USC00121882','USC00122149','USC00122554','USC00122733','USC00122813','USC00122825','USC00123024','USC00123095','USC00123513','USC00123547','USC00123650','USC00123881','USC00124176','USC00124372','USC00124382','USC00124642','USC00124837','USC00125117','USC00125237','USC00125322','USC00125337','USC00125387','USC00125435','USC00126001','USC00126462','USC00126580','USC00126705','USC00126864','USC00127125','USC00127362','USC00127508','USC00127522','USC00127755','USC00127875','USC00127935','USC00127999','USC00128610','USC00128809','USC00128999','USC00129040','USC00129080','USC00129112','USC00129253','USC00129670','USC00129789','USC00130064','USC00130088','USC00130112','USC00130133','USC00130173','USC00130205','USC00130364','USC00130385','USC00130463','USC00130513','USC00130576','USC00130600','USC00130793','USC00130923','USC00131005','USC00131099','USC00131233','USC00131300','USC00131319','USC00131354','USC00131394','USC00131402','USC00131533','USC00131635','USC00131731','USC00131793','USC00131833','USC00131889','USC00131954','USC00132007','USC00132110','USC00132136','USC00132171','USC00132603','USC00132689','USC00132724','USC00132789','USC00132864','USC00132977','USC00132999','USC00133007','USC00133107','USC00133239','USC00133290','USC00133438','USC00133473','USC00133487','USC00133509','USC00133562','USC00133584','USC00133632','USC00133985','USC00134052','USC00134063','USC00134101','USC00134142','USC00134381','USC00134389','USC00134502','USC00134523','USC00134585','USC00134620','USC00134644','USC00134700','USC00134735','USC00134746','USC00134894','USC00135131','USC00135198','USC00135230','USC00135383','USC00135517','USC00135664','USC00135769','USC00135796','USC00135834','USC00135842','USC00135952','USC00136103','USC00136196','USC00136205','USC00136225','USC00136243','USC00136305','USC00136316','USC00136327','USC00136386','USC00136527','USC00136566','USC00136766','USC00136800','USC00136940','USC00137161','USC00137312','USC00137594','USC00137664','USC00137678','USC00137700','USC00137844','USC00137859','USC00137979','USC00138231','USC00138296','USC00138568','USC00138668','USC00138688','USC00138693','USC00138704','USC00138771','USC00138806','USC00138852','USC00139132','USC00140010','USC00140020','USC00140203','USC00140365','USC00140405','USC00140447','USC00140491','USC00140693','USC00141164','USC00141179','USC00141416','USC00141696','USC00141740','USC00141801','USC00141983','USC00142073','USC00142213','USC00142432','USC00142443','USC00142541','USC00142560','USC00142602','USC00142622','USC00142624','USC00142686','USC00142721','USC00142835','USC00142872','USC00142972','USC00142993','USC00143175','USC00143248','USC00143527','USC00143810','USC00143837','USC00143921','USC00143954','USC00144081','USC00144464','USC00144559','USC00144598','USC00144608','USC00144761','USC00144932','USC00144937','USC00144972','USC00145152','USC00145171','USC00145173','USC00145363','USC00145463','USC00145539','USC00145692','USC00145744','USC00145870','USC00145906','USC00145972','USC00146076','USC00146085','USC00146115','USC00146128','USC00146209','USC00146374','USC00146549','USC00147153','USC00147271','USC00147305','USC00147338','USC00147796','USC00148235','USC00148287','USC00148496','USC00148535','USC00148563','USC00148964','USC00148988','USC00149080','USC00150122','USC00150155','USC00150389','USC00150757','USC00151156','USC00151194','USC00151345','USC00151386','USC00151431','USC00152407','USC00152469','USC00152698','USC00152775','USC00153028','USC00153036','USC00153430','USC00153762','USC00153994','USC00154165','USC00154196','USC00154703','USC00154938','USC00155148','USC00155165','USC00155243','USC00155389','USC00155613','USC00155640','USC00156091','USC00156107','USC00156115','USC00156126','USC00156353','USC00156575','USC00156805','USC00157091','USC00157211','USC00157319','USC00157324','USC00158259','USC00158397','USC00158706','USC00160007','USC00160098','USC00160205','USC00160537','USC00160555','USC00161323','USC00161411','USC00161729','USC00161891','USC00161981','USC00162151','USC00162534','USC00162872','USC00163079','USC00163313','USC00163800','USC00164034','USC00164407','USC00164674','USC00164700','USC00165090','USC00165156','USC00165207','USC00165365','USC00165874','USC00166117','USC00166244','USC00166308','USC00166324','USC00166657','USC00166676','USC00166868','USC00167001','USC00167040','USC00167070','USC00167344','USC00167457','USC00167519','USC00167678','USC00167905','USC00168067','USC00168295','USC00168392','USC00168612','USC00168828','USC00169298','USC00169444','USC00169685','USC00170371','USC00170480','USC00170495','USC00171100','USC00171205','USC00171670','USC00172426','USC00172740','USC00172765','USC00172805','USC00173046','USC00174290','USC00174566','USC00175070','USC00175875','USC00176430','USC00176655','USC00176902','USC00177330','USC00179826','USC00180185','USC00180390','USC00180490','USC00180960','USC00180995','USC00181385','USC00181685','USC00181693','USC00181750','USC00181790','USC00181890','USC00181980','USC00181995','USC00182280','USC00182345','USC00182450','USC00182523','USC00182700','USC00182875','USC00182905','USC00183050','USC00183348','USC00183410','USC00183795','USC00183850','USC00183880','USC00183975','USC00184025','USC00184090','USC00184650','USC00185111','USC00185790','USC00185985','USC00186430','USC00187140','USC00187230','USC00187325','USC00187330','USC00187410','USC00187700','USC00188033','USC00188205','USC00188368','USC00188405','USC00188670','USC00188715','USC00188780','USC00189115','USC00189405','USC00189435','USC00189750','USC00190049','USC00190120','USC00190218','USC00190270','USC00190538','USC00190736','USC00190768','USC00190801','USC00190860','USC00190862','USC00190863','USC00191097','USC00191447','USC00191561','USC00191563','USC00191582','USC00191950','USC00192010','USC00192420','USC00192642','USC00192770','USC00192806','USC00192810','USC00192812','USC00192975','USC00193270','USC00193505','USC00193625','USC00193640','USC00193821','USC00193931','USC00194012','USC00194105','USC00194115','USC00194125','USC00194135','USC00194313','USC00194340','USC00194360','USC00194711','USC00194795','USC00194875','USC00195248','USC00195306','USC00195490','USC00196409','USC00196486','USC00196644','USC00196676','USC00196915','USC00196938','USC00196993','USC00197122','USC00197475','USC00198046','USC00198154','USC00198367','USC00198770','USC00198918','USC00199080','USC00199360','USC00199731','USC00199770','USC00199795','USC00199928','USC00199936','USC00200032','USC00200108','USC00200146','USC00200230','USC00200446','USC00200457','USC00200489','USC00200568','USC00200723','USC00200735','USC00200779','USC00200787','USC00200917','USC00201215','USC00201331','USC00201363','USC00201468','USC00201484','USC00201492','USC00201634','USC00201675','USC00202028','USC00202094','USC00202307','USC00202332','USC00202423','USC00202674','USC00202693','USC00202833','USC00202984','USC00203096','USC00203330','USC00203362','USC00203391','USC00203561','USC00203585','USC00203616','USC00203624','USC00203632','USC00203661','USC00203698','USC00203796','USC00203823','USC00203947','USC00203991','USC00204078','USC00204090','USC00204093','USC00204127','USC00204153','USC00204184','USC00204244','USC00204502','USC00204660','USC00204790','USC00204954','USC00204997','USC00205000','USC00205024','USC00205043','USC00205065','USC00205073','USC00205381','USC00205436','USC00205488','USC00205531','USC00205642','USC00205662','USC00205816','USC00206003','USC00206156','USC00206164','USC00206171','USC00206189','USC00206210','USC00206292','USC00206300','USC00206507','USC00206642','USC00206661','USC00206922','USC00207089','USC00207097','USC00207271','USC00207280','USC00207286','USC00207557','USC00207662','USC00207690','USC00207826','USC00208159','USC00208172','USC00208411','USC00208434','USC00208631','USC00208725','USC00208800','USC00208851','USC00208887','USC00208920','USC00209006','USC00210018','USC00210075','USC00210317','USC00210541','USC00210546','USC00210643','USC00210783','USC00210839','USC00210934','USC00211198','USC00211691','USC00211891','USC00211979','USC00212130','USC00212142','USC00212698','USC00212721','USC00212737','USC00212768','USC00213169','USC00213282','USC00213290','USC00213455','USC00213913','USC00213962','USC00214438','USC00214445','USC00214652','USC00214711','USC00214861','USC00214937','USC00214987','USC00214989','USC00215136','USC00215392','USC00215400','USC00215424','USC00215433','USC00215486','USC00215563','USC00215589','USC00215638','USC00215677','USC00215842','USC00215853','USC00215887','USC00215912','USC00216547','USC00216565','USC00216573','USC00216612','USC00217277','USC00217405','USC00217460','USC00217573','USC00218243','USC00218311','USC00218419','USC00218550','USC00218941','USC00219004','USC00219015','USC00219046','USC00219059','USC00219166','USC00219249','USC00220021','USC00220160','USC00220325','USC00220488','USC00220519','USC00220792','USC00220955','USC00221094','USC00221389','USC00221870','USC00221962','USC00222094','USC00222668','USC00222994','USC00223887','USC00223917','USC00223975','USC00224168','USC00224776','USC00224824','USC00224966','USC00225247','USC00225366','USC00225397','USC00226177','USC00226515','USC00226670','USC00226780','USC00227106','USC00227132','USC00227467','USC00228036','USC00228374','USC00228460','USC00228768','USC00229079','USC00229215','USC00229400','USC00229439','USC00229735','USC00229793','USC00229850','USC00230165','USC00230204','USC00230224','USC00230261','USC00230371','USC00230402','USC00230608','USC00230668','USC00230812','USC00231037','USC00231340','USC00231364','USC00231822','USC00231868','USC00231961','USC00232115','USC00232318','USC00232416','USC00232492','USC00232503','USC00232575','USC00232733','USC00232823','USC00233079','USC00233094','USC00233102','USC00233220','USC00233290','USC00233369','USC00233551','USC00233596','USC00233649','USC00233708','USC00233793','USC00234019','USC00234031','USC00234226','USC00234271','USC00234291','USC00234544','USC00234625','USC00234705','USC00234722','USC00234825','USC00234904','USC00234914','USC00235093','USC00235175','USC00235253','USC00235340','USC00235418','USC00235541','USC00235553','USC00235579','USC00235730','USC00235861','USC00235976','USC00235987','USC00236031','USC00236040','USC00236052','USC00236233','USC00236294','USC00236357','USC00236493','USC00236669','USC00236692','USC00236791','USC00236826','USC00236866','USC00237102','USC00237112','USC00237223','USC00237263','USC00237397','USC00237445','USC00237521','USC00237632','USC00237674','USC00237720','USC00237770','USC00238051','USC00238444','USC00238523','USC00238610','USC00238712','USC00238725','USC00238733','USC00238902','USC00238995','USC00239032','USC00239198','USC00240056','USC00240364','USC00240780','USC00240802','USC00241044','USC00241102','USC00241202','USC00241460','USC00241692','USC00241722','USC00241810','USC00241919','USC00242112','USC00242122','USC00242273','USC00242309','USC00242409','USC00242689','USC00243113','USC00243157','USC00243557','USC00243581','USC00243603','USC00243749','USC00243885','USC00243929','USC00244558','USC00245030','USC00245076','USC00245351','USC00245387','USC00245402','USC00245685','USC00245740','USC00246302','USC00246562','USC00246660','USC00246918','USC00246964','USC00247028','USC00247032','USC00248392','USC00248957','USC00249192','USC00249903','USC00250030','USC00250035','USC00250070','USC00250130','USC00250145','USC00250310','USC00250320','USC00250348','USC00250372','USC00250375','USC00250385','USC00250435','USC00250445','USC00250620','USC00250640','USC00250740','USC00250755','USC00250760','USC00250930','USC00250960','USC00251065','USC00251145','USC00251200','USC00251240','USC00251260','USC00251405','USC00251415','USC00251620','USC00251670','USC00251750','USC00251825','USC00251990','USC00252020','USC00252065','USC00252100','USC00252205','USC00252225','USC00252438','USC00252548','USC00252555','USC00252585','USC00252690','USC00252770','USC00252805','USC00252820','USC00252832','USC00252840','USC00253035','USC00253050','USC00253175','USC00253185','USC00253355','USC00253365','USC00253394','USC00253396','USC00253425','USC00253485','USC00253515','USC00253595','USC00253630','USC00253660','USC00253710','USC00253735','USC00253825','USC00253910','USC00253976','USC00254110','USC00254335','USC00254385','USC00254440','USC00254580','USC00254775','USC00254900','USC00254985','USC00255040','USC00255050','USC00255080','USC00255090','USC00255155','USC00255250','USC00255310','USC00255320','USC00255470','USC00255565','USC00255630','USC00255700','USC00255805','USC00255850','USC00255882','USC00255925','USC00255990','USC00256040','USC00256135','USC00256177','USC00256290','USC00256335','USC00256375','USC00256415','USC00256490','USC00256494','USC00256795','USC00256797','USC00256824','USC00257040','USC00257070','USC00257399','USC00257485','USC00257515','USC00257540','USC00257555','USC00257591','USC00257715','USC00258090','USC00258110','USC00258255','USC00258320','USC00258395','USC00258410','USC00258465','USC00258480','USC00258510','USC00258790','USC00258915','USC00258920','USC00259020','USC00259090','USC00259115','USC00259200','USC00259265','USC00259279','USC00259325','USC00259335','USC00259370','USC00259475','USC00259510','USC00260507','USC00260688','USC00260770','USC00260795','USC00261395','USC00261410','USC00261485','USC00261740','USC00262030','USC00262805','USC00263245','USC00263405','USC00263420','USC00263515','USC00263790','USC00263840','USC00264429','USC00264491','USC00264542','USC00264698','USC00264864','USC00265150','USC00265168','USC00265320','USC00265352','USC00265913','USC00265931','USC00266330','USC00266782','USC00267465','USC00268110','USC00268349','USC00268475','USC00268689','USC00268834','USC00268988','USC00270090','USC00270703','USC00271020','USC00271552','USC00271678','USC00271682','USC00272174','USC00273177','USC00273530','USC00273850','USC00274399','USC00274804','USC00275712','USC00275880','USC00275997','USC00276697','USC00276944','USC00277850','USC00278440','USC00278875','USC00280729','USC00280907','USC00281028','USC00281280','USC00281582','USC00281708','USC00282340','USC00282644','USC00283029','USC00283181','USC00283662','USC00283951','USC00284653','USC00284735','USC00285728','USC00286053','USC00286062','USC00286177','USC00286480','USC00286775','USC00287079','USC00287131','USC00287850','USC00288194','USC00288816','USC00288878','USC00288899','USC00289135','USC00290131','USC00290214','USC00290275','USC00290692','USC00290858','USC00290903','USC00291080','USC00291138','USC00291309','USC00291469','USC00291532','USC00291901','USC00292139','USC00292436','USC00292865','USC00292945','USC00293031','USC00293242','USC00293265','USC00293288','USC00293300','USC00293305','USC00293340','USC00293368','USC00293374','USC00293855','USC00294009','USC00294129','USC00294782','USC00294850','USC00295079','USC00295147','USC00296572','USC00297277','USC00297604','USC00298072','USC00298387','USC00298501','USC00299682','USC00299822','USC00300015','USC00300023','USC00300040','USC00300070','USC00300085','USC00300183','USC00300208','USC00300220','USC00300307','USC00300321','USC00300343','USC00300379','USC00300511','USC00300746','USC00300766','USC00300795','USC00300862','USC00300937','USC00301010','USC00301144','USC00301207','USC00301220','USC00301260','USC00301288','USC00301414','USC00301752','USC00301799','USC00301949','USC00302020','USC00302462','USC00302547','USC00302610','USC00302780','USC00302862','USC00303025','USC00303087','USC00303102','USC00303125','USC00303289','USC00303319','USC00303468','USC00303503','USC00303722','USC00303773','USC00303959','USC00303965','USC00304045','USC00304102','USC00304174','USC00304206','USC00304332','USC00304415','USC00304530','USC00304555','USC00304731','USC00304791','USC00304844','USC00304912','USC00304940','USC00304942','USC00305310','USC00305426','USC00305429','USC00305540','USC00305597','USC00305682','USC00305748','USC00305816','USC00305965','USC00305987','USC00306028','USC00306098','USC00306164','USC00306224','USC00306365','USC00306375','USC00306510','USC00306524','USC00306579','USC00306659','USC00306745','USC00306774','USC00306817','USC00306941','USC00306983','USC00307088','USC00307097','USC00307250','USC00307382','USC00307413','USC00307420','USC00307472','USC00307480','USC00307578','USC00307633','USC00307728','USC00307780','USC00307895','USC00307918','USC00308309','USC00308503','USC00308631','USC00308860','USC00308935','USC00308949','USC00308967','USC00309000','USC00309047','USC00309050','USC00309100','USC00309189','USC00309205','USC00309516','USC00310294','USC00311164','USC00311479','USC00311677','USC00311695','USC00312635','USC00313017','USC00313628','USC00313638','USC00313969','USC00313976','USC00314055','USC00314684','USC00314938','USC00315123','USC00315340','USC00315356','USC00315743','USC00315763','USC00315771','USC00315838','USC00315890','USC00315945','USC00315965','USC00316001','USC00316602','USC00316818','USC00317079','USC00317363','USC00317370','USC00317516','USC00317615','USC00317675','USC00317768','USC00317789','USC00317974','USC00318089','USC00318113','USC00318500','USC00319100','USC00319147','USC00319462','USC00320196','USC00320382','USC00320720','USC00320941','USC00321255','USC00321498','USC00322188','USC00322605','USC00323117','USC00323207','USC00323217','USC00323287','USC00323342','USC00323594','USC00323621','USC00324418','USC00324726','USC00325013','USC00325660','USC00325803','USC00325833','USC00325940','USC00326007','USC00326025','USC00326255','USC00326315','USC00327201','USC00327270','USC00327810','USC00328057','USC00328366','USC00328792','USC00329100','USC00329195','USC00329445','USC00329550','USC00330083','USC00330251','USC00330290','USC00330563','USC00330610','USC00330622','USC00330663','USC00330715','USC00330728','USC00330775','USC00330862','USC00331072','USC00331202','USC00331220','USC00331278','USC00331383','USC00331541','USC00331592','USC00331618','USC00331662','USC00331755','USC00331778','USC00332067','USC00332098','USC00332119','USC00332270','USC00332791','USC00332920','USC00333085','USC00333315','USC00333326','USC00333345','USC00333356','USC00333362','USC00333375','USC00333750','USC00333758','USC00333780','USC00333876','USC00333971','USC00334006','USC00334189','USC00334220','USC00334378','USC00334700','USC00334736','USC00334874','USC00334929','USC00334937','USC00335021','USC00335041','USC00335310','USC00335315','USC00335438','USC00335664','USC00335700','USC00335708','USC00335750','USC00335752','USC00335830','USC00335908','USC00336075','USC00336085','USC00336118','USC00336196','USC00336333','USC00336600','USC00336675','USC00336759','USC00336781','USC00336872','USC00337065','USC00337080','USC00337145','USC00337265','USC00337650','USC00337700','USC00337800','USC00337920','USC00337927','USC00338095','USC00338308','USC00338313','USC00338366','USC00338534','USC00338552','USC00338609','USC00338630','USC00338656','USC00338730','USC00338769','USC00338822','USC00338830','USC00338870','USC00338915','USC00339190','USC00339312','USC00339422','USC00340215','USC00340277','USC00340593','USC00340670','USC00340800','USC00341828','USC00342341','USC00342788','USC00342818','USC00342912','USC00343042','USC00343295','USC00343300','USC00343821','USC00343945','USC00344001','USC00344573','USC00344766','USC00344861','USC00345108','USC00345581','USC00345688','USC00345779','USC00346278','USC00346386','USC00346926','USC00346935','USC00347012','USC00347140','USC00347785','USC00347820','USC00347921','USC00348501','USC00348677','USC00348708','USC00348987','USC00349247','USC00349391','USC00349445','USC00349700','USC00349760','USC00350078','USC00350139','USC00350265','USC00350304','USC00350324','USC00350343','USC00350471','USC00350723','USC00350781','USC00350788','USC00351077','USC00351407','USC00351760','USC00351862','USC00352168','USC00352305','USC00352639','USC00352707','USC00352800','USC00352997','USC00353192','USC00353312','USC00353445','USC00353770','USC00353827','USC00354003','USC00354216','USC00354329','USC00354342','USC00354420','USC00354506','USC00354612','USC00354670','USC00354720','USC00355014','USC00355375','USC00355384','USC00355490','USC00355621','USC00355689','USC00355770','USC00355969','USC00356004','USC00356541','USC00356698','USC00356853','USC00356883','USC00357160','USC00357169','USC00357208','USC00357760','USC00357814','USC00357827','USC00357848','USC00357955','USC00358016','USC00358034','USC00358190','USC00358407','USC00358508','USC00358545','USC00358734','USC00358879','USC00359186','USC00359216','USC00359390','USC00360076','USC00360134','USC00360212','USC00360279','USC00360464','USC00360530','USC00360634','USC00361001','USC00361017','USC00361130','USC00361234','USC00361282','USC00361301','USC00361324','USC00361354','USC00361485','USC00361589','USC00361631','USC00361710','USC00361766','USC00362041','USC00362108','USC00362236','USC00362245','USC00362290','USC00362324','USC00362331','USC00362358','USC00362425','USC00362569','USC00362633','USC00362662','USC00362721','USC00363028','USC00363413','USC00363503','USC00363632','USC00363651','USC00363706','USC00363711','USC00363758','USC00363769','USC00363831','USC00364159','USC00364276','USC00364385','USC00364533','USC00364758','USC00364873','USC00364891','USC00364972','USC00364979','USC00365101','USC00365104','USC00365259','USC00365479','USC00365720','USC00366204','USC00366531','USC00366719','USC00366904','USC00366914','USC00367239','USC00367409','USC00367497','USC00367734','USC00367762','USC00367863','USC00367931','USC00368190','USC00368249','USC00368303','USC00368449','USC00368662','USC00368717','USC00368732','USC00368905','USC00369050','USC00369298','USC00369407','USC00369464','USC00369500','USC00369555','USC00369702','USC00369733','USC00369933','USC00371175','USC00374266','USC00375110','USC00375882','USC00376453','USC00376710','USC00376712','USC00380124','USC00380506','USC00380559','USC00380764','USC00381277','USC00381310','USC00381588','USC00381770','USC00381937','USC00381997','USC00382260','USC00382720','USC00382757','USC00382917','USC00383109','USC00383356','USC00383468','USC00383505','USC00383742','USC00383754','USC00384753','USC00385130','USC00385200','USC00385633','USC00386209','USC00386890','USC00387542','USC00387560','USC00387575','USC00387722','USC00387830','USC00387980','USC00388114','USC00388360','USC00388426','USC00388714','USC00388887','USC00389327','USC00389350','USC00389469','USC00390043','USC00390128','USC00390296','USC00390535','USC00390834','USC00391076','USC00391294','USC00391392','USC00391579','USC00391609','USC00391739','USC00392302','USC00392618','USC00392888','USC00392927','USC00392984','USC00393029','USC00393044','USC00393079','USC00393217','USC00393249','USC00393410','USC00393440','USC00393832','USC00393885','USC00394007','USC00394037','USC00394179','USC00394206','USC00394516','USC00394576','USC00394661','USC00394891','USC00394900','USC00395456','USC00395481','USC00395536','USC00395671','USC00395735','USC00395800','USC00396212','USC00396650','USC00397047','USC00397227','USC00397287','USC00397590','USC00397640','USC00397742','USC00397882','USC00398472','USC00398622','USC00399042','USC00399070','USC00399430','USC00400271','USC00400847','USC00400876','USC00401145','USC00401312','USC00401480','USC00401553','USC00401636','USC00401790','USC00401835','USC00401916','USC00402108','USC00402385','USC00402489','USC00402589','USC00402806','USC00402836','USC00403280','USC00403679','USC00403907','USC00404223','USC00404561','USC00404673','USC00404871','USC00405187','USC00405216','USC00405442','USC00405535','USC00405560','USC00405862','USC00405882','USC00406012','USC00406287','USC00406371','USC00406534','USC00406950','USC00407007','USC00407099','USC00407884','USC00407979','USC00408108','USC00408184','USC00408873','USC00408886','USC00409155','USC00409219','USC00409502','USC00409752','USC00410120','USC00410144','USC00410174','USC00410204','USC00410262','USC00410268','USC00410367','USC00410420','USC00410493','USC00410542','USC00410832','USC00410902','USC00410984','USC00411007','USC00411034','USC00411073','USC00411138','USC00411250','USC00411875','USC00411888','USC00411903','USC00411956','USC00412121','USC00412243','USC00412266','USC00412444','USC00412655','USC00412679','USC00412902','USC00412965','USC00413156','USC00413247','USC00413267','USC00413277','USC00413329','USC00413415','USC00413485','USC00413506','USC00413734','USC00413873','USC00413992','USC00414122','USC00414254','USC00414358','USC00414474','USC00414524','USC00414563','USC00414670','USC00414705','USC00414767','USC00414866','USC00415018','USC00415089','USC00415272','USC00415550','USC00415822','USC00416000','USC00416176','USC00416276','USC00416790','USC00416794','USC00417179','USC00417572','USC00417622','USC00417693','USC00417756','USC00417836','USC00417875','USC00417887','USC00417948','USC00418022','USC00418081','USC00418728','USC00418743','USC00418910','USC00419139','USC00419176','USC00419275','USC00419365','USC00419421','USC00419522','USC00420061','USC00420157','USC00420730','USC00420777','USC00420924','USC00421214','USC00421440','USC00421731','USC00421850','USC00422101','USC00422721','USC00422828','USC00422851','USC00423032','USC00423220','USC00423320','USC00423809','USC00423842','USC00423968','USC00424123','USC00424508','USC00424575','USC00424856','USC00425065','USC00425148','USC00425186','USC00425247','USC00425402','USC00425488','USC00425705','USC00425723','USC00425733','USC00425930','USC00426400','USC00426590','USC00426648','USC00426686','USC00426874','USC00427050','USC00427260','USC00427516','USC00427714','USC00427895','USC00427931','USC00427959','USC00428600','USC00428640','USC00428672','USC00428771','USC00428847','USC00429111','USC00429365','USC00429595','USC00430563','USC00431072','USC00431360','USC00431580','USC00431730','USC00432769','USC00433800','USC00434150','USC00434882','USC00435733','USC00436020','USC00437054','USC00438600','USC00438905','USC00439984','USC00440097','USC00440327','USC00440440','USC00440551','USC00440737','USC00440755','USC00440765','USC00440880','USC00441136','USC00441200','USC00441209','USC00441593','USC00441691','USC00441746','USC00441801','USC00441929','USC00442208','USC00442245','USC00442460','USC00442941','USC00443192','USC00443713','USC00444128','USC00444876','USC00444909','USC00445121','USC00445213','USC00445266','USC00446054','USC00446979','USC00446997','USC00447196','USC00447338','USC00447435','USC00447490','USC00447976','USC00448035','USC00448062','USC00448080','USC00448220','USC00448475','USC00448888','USC00448894','USC00448984','USC00449020','USC00449146','USC00449263','USC00449301','USC00450008','USC00450176','USC00450285','USC00450569','USC00450872','USC00450890','USC00450897','USC00451233','USC00451237','USC00451257','USC00451330','USC00451362','USC00451496','USC00451504','USC00451586','USC00451630','USC00451666','USC00451689','USC00451783','USC00451830','USC00451944','USC00452030','USC00452376','USC00452505','USC00452511','USC00453268','USC00453276','USC00453765','USC00453985','USC00454154','USC00454328','USC00454430','USC00454782','USC00454884','USC00455105','USC00455539','USC00455656','USC00455670','USC00455686','USC00455946','USC00456096','USC00456109','USC00456400','USC00456610','USC00456678','USC00456784','USC00456970','USC00456974','USC00457059','USC00457180','USC00457507','USC00457650','USC00457756','USC00457773','USC00457956','USC00458007','USC00458207','USC00458694','USC00458773','USC00458802','USC00459012','USC00459077','USC00459238','USC00459291','USC00460450','USC00460580','USC00460687','USC00460740','USC00460918','USC00461220','USC00461260','USC00461328','USC00461515','USC00461696','USC00462054','USC00462590','USC00462709','USC00462920','USC00463544','USC00463630','USC00463672','USC00463846','USC00463927','USC00464170','USC00464378','USC00465224','USC00465445','USC00465563','USC00465672','USC00465705','USC00466163','USC00466207','USC00466343','USC00466467','USC00466565','USC00466602','USC00466867','USC00466982','USC00467105','USC00467135','USC00467207','USC00467614','USC00467730','USC00467785','USC00468384','USC00469049','USC00469368','USC00469436','USC00469483','USC00469605','USC00470205','USC00470239','USC00470349','USC00470565','USC00470603','USC00470696','USC00471078','USC00471245','USC00471568','USC00471600','USC00472050','USC00472173','USC00472423','USC00472822','USC00472839','USC00473214','USC00473242','USC00473250','USC00473453','USC00473461','USC00473511','USC00473532','USC00473649','USC00474230','USC00474295','USC00474375','USC00474379','USC00474482','USC00474546','USC00474966','USC00475017','USC00475236','USC00475255','USC00475298','USC00475484','USC00475808','USC00475910','USC00475932','USC00476208','USC00476320','USC00476330','USC00476470','USC00476594','USC00476718','USC00476764','USC00476827','USC00476859','USC00476922','USC00477650','USC00477708','USC00477725','USC00478027','USC00478171','USC00478805','USC00478827','USC00478919','USC00478937','USC00478951','USC00478971','USC00478978','USC00479050','USC00479095','USC00480090','USC00480540','USC00480605','USC00481165','USC00481240','USC00481500','USC00481565','USC00481610','USC00481730','USC00482235','USC00482638','USC00483100','USC00483485','USC00483610','USC00484796','USC00484875','USC00485055','USC00485165','USC00485410','USC00485770','USC00485830','USC00487078','USC00488163','USC00488170','USC00488385','USC00488868','USC00488875','USC00489459','USC00489615','USC00489905','USC00501977','USC00502041','USC00503162','USC00503655','USC00504092','USC00504689','USC00506844','USC00507891','USC00508114','USC00508503','USC00508525','USC00509494','USC00509902','USC00512146','USW00003124','USW00004782','USW00012841','USW00012919','USW00012930','USW00012944','USW00012945','USW00013713','USW00013724','USW00013745','USW00013777','USW00013779','USW00013780','USW00013782','USW00013872','USW00013941','USW00013966','USW00013972','USW00013976','USW00013977','USW00013980','USW00013981','USW00013984','USW00013991','USW00013998','USW00014717','USW00014734','USW00014743','USW00014767','USW00014804','USW00014806','USW00014828','USW00014834','USW00014840','USW00014844','USW00014845','USW00014848','USW00014850','USW00014898','USW00014924','USW00014929','USW00014931','USW00014934','USW00014936','USW00014946','USW00023043','USW00023066','USW00023080','USW00023154','USW00023157','USW00023194','USW00023271','USW00024020','USW00024025','USW00024028','USW00024035','USW00024036','USW00024121','USW00024128','USW00024135','USW00024157','USW00024216','USW00024231','USW00024232','USW00024274','USW00024281','USW00024285','USW00026413','USW00026523','USW00026616','USW00026617','USW00053875','USW00054936','USW00093145','USW00093725','USW00093807','USW00093808','USW00093820','USW00093852','USW00093958','USW00093963','USW00093972','USW00094014','USW00094104','USW00094701','USW00094728','USW00094967'
    --WBAN in 1900
    --'USW00003124','USW00004782','USW00012841','USW00012919','USW00012930','USW00012944','USW00012945','USW00013713','USW00013724','USW00013745','USW00013777','USW00013779','USW00013780','USW00013782','USW00013872','USW00013941','USW00013966','USW00013972','USW00013976','USW00013977','USW00013980','USW00013981','USW00013984','USW00013991','USW00013998','USW00014717','USW00014734','USW00014743','USW00014767','USW00014804','USW00014806','USW00014828','USW00014834','USW00014840','USW00014844','USW00014845','USW00014848','USW00014850','USW00014898','USW00014924','USW00014929','USW00014931','USW00014934','USW00014936','USW00014946','USW00023043','USW00023066','USW00023080','USW00023154','USW00023157','USW00023194','USW00023271','USW00024020','USW00024025','USW00024028','USW00024035','USW00024036','USW00024121','USW00024128','USW00024135','USW00024157','USW00024216','USW00024231','USW00024232','USW00024274','USW00024281','USW00024285','USW00026413','USW00026523','USW00026616','USW00026617','USW00053875','USW00054936','USW00093145','USW00093725','USW00093807','USW00093808','USW00093820','USW00093852','USW00093958','USW00093963','USW00093972','USW00094014','USW00094104','USW00094701','USW00094728','USW00094967'
)
and state = 'CO'
order by state

--update ghcn.station
--set
--    enabled = true
--where id in ('US1COAD0132', 'US1COAD0153', 'US1COAD0003', 'US1COAD0001', 'US1CODN0073')

select * from ghcn.daily_raw;
--delete from ghcn.daily_raw;

select count(distinct date) from ghcn.daily_raw;

select * from ghcn.daily_raw
where mflag is not NULL

select distinct mflag from ghcn.daily_raw
where mflag is not NULL

select * from ghcn.daily_raw
where qflag is not NULL

select distinct qflag from ghcn.daily_raw
where qflag is not NULL

select stationid, date, count(*)
from ghcn.daily_raw
group by stationid, date
having count(*) < 4;

select stationid, date
from ghcn.daily_raw
where (stationid, date) not in (
    select stationid, date
    from ghcn.daily_raw
    where element = 'TMIN'
)

select * from ghcn.daily_raw
join ghcn.station s on stationid = s.id
where stationid = 'USC00051401'
and date = '2010-01-24'

select count(*) from ghcn.daily_raw;
select * from ghcn.daily;
select stationid, date, obstime, count(*) from ghcn.daily
GROUP by stationid, date, obstime
having count(*) > 1

select ghcn.stp_daily();
select * from ghcn.daily;
select count(*) from ghcn.daily;
select date_part('year', date) as years, count(date_part('year', date)) as recordcount
from ghcn.daily
group by date_part('year', date)
order by years;

--todo: use lag to see if years are all sequential


select count(distinct date) from ghcn.daily
select min(date), max(date) from ghcn.daily

select stationid, date_part('year', date), count(*)
from ghcn.daily d 
left join ghcn.station s on d.stationid = s.id
where tmax is not NULL and tmin is not null
group by stationid, date_part('year', date)
having count(*) <> 365
order by date_part('year', date), stationid

select * from ghcn.daily
where stationid = 'USC00051401'
and date_part('year', date) = 2000
and tmax is not NULL and tmin is not null
order by date

--TMAX = Maximum temperature (tenths of degrees C)
--TMIN = Minimum temperature (tenths of degrees C)
--(C x 9/5) + 32 = F’
--full view
select --*
    stationid
    ,s.name
    ,s.state
    ,date
    ,obstime
    --,tmax
    ,round(((tmax / 10.0) * (9.0/5.0)) + 32, 2) as tmax_f
    --,tmin
    ,round(((tmin / 10.0) * (9.0/5.0)) + 32, 2) as tmin_f
    ,round(((((tmax + tmin) / 2) / 10.0) * (9.0/5.0)) + 32, 2) as tavg_f
from ghcn.daily d 
left join ghcn.station s on d.stationid = s.id
where tmax is not NULL and tmin is not null
and s.state = 'CO'
order by stationid, date

--temperature for current day over past years
select 
    stationid
    ,s.name
    ,s.state
    ,date
    ,obstime
    --,tmax
    ,round(((tmax / 10.0) * (9.0/5.0)) + 32, 2) as tmax_f
    --,tmin
    ,round(((tmin / 10.0) * (9.0/5.0)) + 32, 2) as tmin_f
    ,round(((((tmax + tmin) / 2) / 10.0) * (9.0/5.0)) + 32, 2) as tavg_f
from ghcn.daily d 
left join ghcn.station s on d.stationid = s.id
where tmax is not NULL and tmin is not null
and s.state = 'CO'
and stationid not in ('USW00023066')
and date_part('month', date) = date_part('month', NOW())
and date_part('day', date) = date_part('day', NOW())
order by stationid, date